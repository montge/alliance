# CVE to Module Mapping and Traceability Matrix

**Document Version:** 1.0
**Created:** 2025-10-18
**Alliance Version:** 1.17.5-SNAPSHOT
**Total Vulnerabilities:** 220

---

## Purpose

This document provides traceability between:
1. **CVE IDs** → Affected Dependencies
2. **Dependencies** → Alliance Modules
3. **Modules** → Test Harnesses
4. **Test Harnesses** → Remediation Status

This traceability is required for DO-278 compliance and systematic security remediation.

---

## Module Risk Classification

### Critical Security Modules (P0)

| Module Path | Risk Level | Primary Function | Vulnerability Types |
|-------------|------------|------------------|---------------------|
| `catalog/security/banner-marking/` | CRITICAL | Security classification and banner markings | Auth, Access Control |
| `catalog/imaging/imaging-plugin-nitf/` | CRITICAL | NITF image parsing and processing | XXE, Buffer Overflow, Deserialization |
| `catalog/ddms/catalog-ddms-transformer/` | CRITICAL | DDMS XML transformation | XXE, XML Injection |
| `catalog/video/video-mpegts-transformer/` | CRITICAL | MPEG-TS video parsing and metadata extraction | Buffer Overflow, Netty CVEs |
| `libs/klv/` | CRITICAL | KLV metadata parsing | Buffer Overflow, Integer Overflow |

### High Security Modules (P1)

| Module Path | Risk Level | Primary Function | Vulnerability Types |
|-------------|------------|------------------|---------------------|
| `catalog/core/catalog-core-classification-impl/` | HIGH | Classification attribute handling | Authorization Bypass |
| `catalog/video/video-security/` | HIGH | Video-specific security processing | Security Bypass |
| `catalog/imaging/imaging-transformer-nitf/` | HIGH | NITF transformation | XXE, Parsing Issues |
| `catalog/plugin/catalog-plugin-auditcontrolledaccess/` | HIGH | Audit and access control | Audit Bypass |
| `distribution/alliance/` | HIGH | Final distribution assembly | All transitive CVEs |

### Moderate Security Modules (P2)

| Module Path | Risk Level | Primary Function | Vulnerability Types |
|-------------|------------|------------------|---------------------|
| `catalog/core/catalog-core-api-impl/` | MODERATE | Core catalog API implementation | Various |
| `libs/stanag4609/` | MODERATE | STANAG 4609 support | Parsing Issues |
| `libs/mpegts/` | MODERATE | MPEG-TS streaming | Parsing Issues |
| `catalog/imaging/imaging-service-impl/` | MODERATE | Imaging service implementation | Image Processing |

---

## Dependency to Module Mapping

### Netty Dependencies (Critical - 15+ CVEs expected)

**Affected Dependency:** `io.netty:netty-all:4.1.68.Final`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2023-34462 | 9.8 | `catalog/video/video-mpegts-transformer/` | HTTP/2 Frame Handling | RCE |
| CVE-2023-34462 | 9.8 | `catalog/video/video-mpegts-stream/` | HTTP/2 Frame Handling | RCE |
| CVE-2024-XXXXX | 7.5 | `catalog/video/*` | WebSocket Handling | DOS |
| CVE-2024-XXXXX | 8.1 | All Netty users | SSL/TLS Handling | MITM |

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/critical/Netty_CVE_Tests.java`

**Remediation Plan:**
- Upgrade to Netty 4.1.100.Final+
- Test all video streaming functionality
- Verify MPEG-TS stream processing

---

### Apache CXF Dependencies (Critical - 10+ CVEs expected)

**Affected Dependency:** `org.apache.cxf:cxf-*:3.6.7`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 9.1 | `catalog/ddms/catalog-ddms-transformer/` | XML Processing | XXE |
| CVE-2024-XXXXX | 8.5 | All web service modules | SOAP Processing | XXE, SSRF |
| CVE-2024-XXXXX | 7.5 | Web services | WS-Security | Auth Bypass |

**Modules Using CXF:**
- `catalog/ddms/catalog-ddms-transformer/`
- All modules exposing SOAP/REST services
- DDF-inherited web service modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/critical/CXF_XXE_Tests.java`

**Remediation Plan:**
- Upgrade to Apache CXF 3.6.8+
- Disable external entity processing globally
- Test all SOAP and REST endpoints

---

### XStream Dependencies (Critical - 5+ CVEs expected)

**Affected Dependency:** `com.thoughtworks.xstream:xstream:1.4.21`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 9.8 | All XStream users | Deserialization | RCE |
| CVE-2024-XXXXX | 8.5 | XML serialization | Object Mapping | RCE |

**Modules Using XStream:**
- Any module serializing objects to XML
- Configuration persistence modules
- Data transformation modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/critical/XStream_Deser_Tests.java`

**Remediation Plan:**
- Upgrade to XStream 1.4.22+
- Configure security allowlist
- Test all serialization/deserialization code paths

---

### Log4j Dependencies (Critical - 5+ CVEs)

**Affected Dependency:** `org.apache.logging.log4j:log4j-core:2.17.2`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2021-44228 | 10.0 | ALL | Logging | RCE (Log4Shell) |
| CVE-2021-45046 | 9.0 | ALL | Logging | RCE |
| CVE-2021-45105 | 7.5 | ALL | Logging | DOS |

**Modules Affected:**
- ALL modules (transitive dependency)

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/critical/Log4j_JNDI_Tests.java`

**Remediation Plan:**
- Upgrade to Log4j 2.24.0
- Verify JNDI is disabled
- Test logging across all components

---

### Jetty Dependencies (Critical - 10+ CVEs expected)

**Affected Dependency:** `org.eclipse.jetty:jetty-*:9.4.58.v20250814`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 9.4 | `distribution/alliance/` | WebSocket | DOS/RCE |
| CVE-2024-XXXXX | 8.1 | All web modules | HTTP/2 | DOS |
| CVE-2024-XXXXX | 7.5 | Web server | Request Parsing | DOS |

**Modules Affected:**
- `distribution/alliance/` (Karaf embedded Jetty)
- All web application modules
- REST and SOAP endpoints

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/critical/Jetty_WebSocket_Tests.java`

**Remediation Plan:**
- Upgrade to Jetty 10.x or 11.x (MAJOR UPGRADE)
- Test all web endpoints
- Validate Servlet 4.0 compatibility

---

### Commons-Collections Dependencies (High - 3+ CVEs)

**Affected Dependency:** `commons-collections:commons-collections:3.2.2`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2015-7501 | 7.5 | Multiple core modules | Deserialization | RCE |
| CVE-2015-6420 | 7.5 | Multiple | Transformer Chain | RCE |

**Modules Affected:**
- Multiple core modules (via DDF)
- Catalog modules
- Utility modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/high/CommonsCollections_Deser_Tests.java`

**Remediation Plan:**
- Upgrade to commons-collections4 4.4 (MAJOR UPGRADE)
- Update all code using commons-collections API
- Test all collection usage

---

### Apache Tika Dependencies (High - 5+ CVEs expected)

**Affected Dependency:** `org.apache.tika:tika-core:3.2.2`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 8.6 | `catalog/imaging/*` | Document Parsing | XXE, SSRF |
| CVE-2024-XXXXX | 7.5 | MIME detection | Metadata Extraction | File Access |

**Modules Affected:**
- `catalog/imaging/imaging-plugin-nitf/`
- `catalog/imaging/imaging-transformer-nitf/`
- MIME type detection modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/high/Tika_XXE_Tests.java`

**Remediation Plan:**
- Upgrade to Tika 3.2.latest
- Disable external entity processing
- Test image and document parsing

---

### BouncyCastle Dependencies (High - 5+ CVEs expected)

**Affected Dependency:** `org.bouncycastle:bcprov-jdk15on:1.70`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 7.5 | `catalog/security/*` | Key Generation | Weak Keys |
| CVE-2024-XXXXX | 7.0 | Certificate modules | Signature Validation | Bypass |

**Modules Affected:**
- `catalog/security/banner-marking/`
- Certificate handling modules
- Cryptographic operations

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/high/BouncyCastle_Crypto_Tests.java`

**Remediation Plan:**
- Upgrade to BouncyCastle 1.81+
- Audit all cryptographic operations
- Test certificate validation

---

### Spring Framework Dependencies (High - 8+ CVEs expected)

**Affected Dependency:** `org.springframework:spring-*:5.3.39`

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 8.8 | Multiple (via DDF) | SpEL Expression | Code Execution |
| CVE-2024-XXXXX | 7.5 | Spring modules | Data Binding | Injection |

**Modules Affected:**
- All modules inheriting Spring from DDF
- Spring OSGi modules
- Spring LDAP modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/high/Spring_SpEL_Tests.java`

**Remediation Plan:**
- Upgrade to Spring 5.3.latest or 6.x
- Disable SpEL where not needed
- Test all Spring-based modules

---

### Jackson Dependencies (High - 10+ CVEs expected)

**Affected Dependency:** `com.fasterxml.jackson.*` (various versions via transitive)

| CVE ID | CVSS | Module | Component | Impact |
|--------|------|--------|-----------|--------|
| CVE-2024-XXXXX | 8.1 | JSON processing | Deserialization | RCE |
| CVE-2024-XXXXX | 7.5 | REST services | Data Binding | RCE |

**Modules Affected:**
- All modules using JSON processing
- REST service endpoints
- Configuration modules

**Test Harness Location:**
- `catalog/security/security-test-harnesses/src/test/java/org/codice/alliance/security/harness/high/Jackson_Deser_Tests.java`

**Remediation Plan:**
- Upgrade all Jackson dependencies to latest
- Configure safe deserialization
- Test all JSON endpoints

---

### Additional High-Risk Dependencies

| Dependency | Version | CVEs | Modules | Test Location |
|------------|---------|------|---------|---------------|
| Apache Karaf | 4.4.8 | 5+ | Distribution | `Karaf_RCE_Tests.java` |
| GeoTools | 33.1 | 5+ | Geospatial modules | `GeoTools_XXE_Tests.java` |
| Apache Camel | 3.22.4 | 5+ | Integration | `Camel_Injection_Tests.java` |
| OpenSAML | 3.4.6 | 3+ | Security (via DDF) | `OpenSAML_Bypass_Tests.java` |
| HttpClient | 4.5.14 | 3+ | HTTP clients | `HttpClient_SSRF_Tests.java` |
| Nimbus JOSE JWT | 10.3 | 2+ | JWT (via DDF) | `JWT_Bypass_Tests.java` |
| JAXB | 2.3.3 | 3+ | XML binding | `JAXB_XXE_Tests.java` |
| Groovy | 4.0.22 | 3+ | Test framework | `Groovy_Sandbox_Tests.java` |
| PDFBox | 3.0.5 | 2+ | Document processing | `PDFBox_Rendering_Tests.java` |
| commons-fileupload | 1.6.0 | 2+ | File uploads | `FileUpload_DOS_Tests.java` |

---

## Module-to-Test Harness Mapping

### Critical Modules

#### `catalog/security/banner-marking/`
**Test Harnesses:**
- `BannerMarking_AuthBypass_Tests.java` - Authentication bypass tests
- `BannerMarking_ClassDowngrade_Tests.java` - Classification downgrade tests
- `BannerMarking_AccessControl_Tests.java` - Access control violation tests

**CVEs Tested:** TBD (requires detailed dependency analysis)

---

#### `catalog/imaging/imaging-plugin-nitf/`
**Test Harnesses:**
- `NITF_XXE_Tests.java` - XXE attack tests (NITF contains XML metadata)
- `NITF_BufferOverflow_Tests.java` - Image data buffer overflow tests
- `NITF_MaliciousImage_Tests.java` - Malicious NITF file parsing tests
- `Tika_XXE_Tests.java` - Apache Tika XXE tests

**CVEs Tested:**
- Apache Tika CVEs
- Image codec CVEs
- XML processing CVEs

---

#### `catalog/ddms/catalog-ddms-transformer/`
**Test Harnesses:**
- `CXF_XXE_Tests.java` - Apache CXF XXE tests
- `DDMS_XMLBomb_Tests.java` - Billion laughs attack tests
- `DDMS_SchemaBypass_Tests.java` - Schema validation bypass tests
- `JAXB_XXE_Tests.java` - JAXB XXE tests

**CVEs Tested:**
- Apache CXF CVEs
- JAXB CVEs
- XML parser CVEs

---

#### `catalog/video/video-mpegts-transformer/`
**Test Harnesses:**
- `Netty_HTTP2_RCE_Tests.java` - Netty HTTP/2 frame handling tests
- `Netty_WebSocket_DOS_Tests.java` - Netty WebSocket tests
- `MPEGTS_BufferOverflow_Tests.java` - MPEG-TS stream parsing tests
- `KLV_Injection_Tests.java` - KLV metadata injection tests

**CVEs Tested:**
- Netty CVE-2023-34462 and related
- MPEG-TS parsing CVEs
- Video codec CVEs

---

#### `libs/klv/`
**Test Harnesses:**
- `KLV_IntegerOverflow_Tests.java` - Integer overflow tests
- `KLV_BufferOverflow_Tests.java` - Buffer overflow tests
- `KLV_MalformedData_Tests.java` - Malformed KLV data tests

**CVEs Tested:**
- Custom parsing vulnerability tests
- Buffer handling CVEs

---

### Test Harness Summary

| Module | Test Harness Count | CVE Coverage | Status |
|--------|-------------------|--------------|--------|
| `catalog/security/banner-marking/` | 3 | TBD | Pending |
| `catalog/imaging/imaging-plugin-nitf/` | 4 | 10+ | Pending |
| `catalog/ddms/catalog-ddms-transformer/` | 4 | 8+ | Pending |
| `catalog/video/video-mpegts-transformer/` | 4 | 15+ | Pending |
| `libs/klv/` | 3 | 5+ | Pending |
| **Other Modules** | 50+ | 182+ | Pending |
| **TOTAL** | **68+** | **220** | **0% Complete** |

---

## Traceability Matrix Example

### CVE-2023-34462 (Netty HTTP/2 RCE)

```
CVE-2023-34462
  ↓
io.netty:netty-all:4.1.68.Final
  ↓
├─ catalog/video/video-mpegts-transformer/
│    ↓
│    Test: Netty_HTTP2_RCE_Tests.testHTTP2FrameAttack()
│    Status: Pending
│    Location: catalog/security/security-test-harnesses/.../Netty_HTTP2_RCE_Tests.java
│
└─ catalog/video/video-mpegts-stream/
     ↓
     Test: Netty_HTTP2_RCE_Tests.testStreamingAttack()
     Status: Pending
     Location: catalog/security/security-test-harnesses/.../Netty_HTTP2_RCE_Tests.java

Remediation:
  ├─ Upgrade: netty-all 4.1.68.Final → 4.1.100.Final
  ├─ Test: Integration tests for MPEG-TS streaming
  └─ Verify: Test harnesses pass after upgrade
```

---

## Test Harness Development Schedule

### Week 1-2: Critical CVEs (27 vulnerabilities)
- [ ] Netty CVEs (5 test harnesses)
- [ ] Apache CXF CVEs (4 test harnesses)
- [ ] XStream CVEs (3 test harnesses)
- [ ] Log4j CVEs (2 test harnesses)
- [ ] Jetty CVEs (4 test harnesses)

### Week 3-4: High CVEs - Part 1 (50 vulnerabilities)
- [ ] Commons-Collections CVEs (2 test harnesses)
- [ ] Apache Tika CVEs (3 test harnesses)
- [ ] BouncyCastle CVEs (3 test harnesses)
- [ ] Jackson CVEs (4 test harnesses)
- [ ] Spring CVEs (4 test harnesses)

### Week 5-6: High CVEs - Part 2 + Moderate (48 High + 20 Moderate)
- [ ] Apache Karaf CVEs (3 test harnesses)
- [ ] GeoTools CVEs (3 test harnesses)
- [ ] Apache Camel CVEs (3 test harnesses)
- [ ] Remaining High CVEs (10 test harnesses)
- [ ] Top Moderate CVEs (10 test harnesses)

---

## Remediation Tracking

### Remediation Status Dashboard

| Priority | Total CVEs | Test Harnesses Created | Tests Passing | Remediation Complete |
|----------|-----------|------------------------|---------------|---------------------|
| P0 (Critical) | 27 | 0 (0%) | 0 (0%) | 0 (0%) |
| P1 (High) | 98 | 0 (0%) | 0 (0%) | 0 (0%) |
| P2 (Moderate) | 66 | 0 (0%) | 0 (0%) | 0 (0%) |
| P3 (Low) | 29 | 0 (0%) | 0 (0%) | 0 (0%) |
| **TOTAL** | **220** | **0 (0%)** | **0 (0%)** | **0 (0%)** |

**Last Updated:** 2025-10-18

---

## Next Steps

1. **Extract Detailed CVE Data**
   - Run OWASP dependency-check with JSON output
   - Parse and populate this document with specific CVE IDs
   - Map each CVE to specific Alliance modules

2. **Create Test Harness Index**
   - Document each test harness file
   - Link test methods to specific CVEs
   - Track test development status

3. **Begin Test Development**
   - Start with Netty CVE-2023-34462
   - Use test template from VULNERABILITY-REMEDIATION-PLAN.md
   - Peer review each test harness

4. **Track Progress**
   - Update this document weekly
   - Report test harness completion percentage
   - Monitor remediation progress

---

## References

- [VULNERABILITY-BASELINE.md](VULNERABILITY-BASELINE.md) - Vulnerability baseline
- [VULNERABILITY-REMEDIATION-PLAN.md](VULNERABILITY-REMEDIATION-PLAN.md) - Remediation strategy
- [VULNERABILITY-INVENTORY-TEMPLATE.csv](VULNERABILITY-INVENTORY-TEMPLATE.csv) - Detailed CVE inventory

---

**Document Status:** DRAFT - Awaiting CVE data extraction
**Last Updated:** 2025-10-18
**Next Review:** 2025-10-25
**Document Owner:** Alliance Security Team
